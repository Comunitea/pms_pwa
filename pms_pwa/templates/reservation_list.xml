<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <template id="roomdoo_reservation_list" name="Reservation list">
        <t t-call="website.layout">
            <div class="o_pms_pwa_roomdoo_reservation_modal" />
            <div class="oe_structure">
                <section class="container-fluid o_pms_pwa_roomdoo">
                    <h2><strong>My bookings <span t-esc="'('+str(len(reservations))+')'"/></strong></h2>
                    <div class="row">
                        <div class="col-8 col-md-8 col-lg-5">
                            <input type="text" class="form-control o_pmw_pwa_search_input" placeholder="Search" title="Search..." />
                        </div>
                        <div class="col-4 col-md-4 col-lg-7">
                            <span class="dropdown">
                                <a role="button" class="btn btn-outline-dark o_pms_pwa_float_right" data-toggle="dropdown" href="#">
                                    <i class="fa fa-bars d-sm-block d-md-block d-lg-none"/>
                                    <span class="d-none d-lg-flex align-self-center">FILTERS</span>
                                </a>
                                <div class="dropdown-menu" aria-labelledby="dLabel">
                                    <button class="dropdown-item" type="button">Check in</button>
                                    <button class="dropdown-item" type="button">Check out</button>
                                    <button class="dropdown-item" type="button">Cancelled</button>
                                </div>
                            </span>
                        </div>
                    </div>

                    <div class="tags_holder"/>

                    <div class="table-wrapper">
                        <table class="table table-hover o_pms_pwa_reservation_list_table">
                            <thead>
                                <tr>
                                    <th>Guest</th>
                                    <th>ID</th>
                                    <th>Room type</th>
                                    <th class="text-center">Room nº</th>
                                    <th>Check in</th>
                                    <th>Check out</th>
                                    <th class="text-center">Sales channel</th>
                                    <th class="text-center">Total(€)</th>
                                    <th class="text-center">Outstanding(€)</th>
                                    <th class="text-center">Room qty</th>
                                    <th>Requests</th>
                                    <th>Services</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="reservations" t-as="obj">
                                    <tr class="o_pms_pwa_reservation" t-att-data-id="obj.id">
                                        <td class="first-col">
                                            <span class="float-left">
                                                <img t-att-src="website.image_url(obj.partner_id, 'image_128')"
                                                    width="50"
                                                    class="img-thumbnail rounded-circle o_pms_pwa_img_rounded_bg"
                                                    t-att-title="obj.partner_id.name" t-att-alt="obj.partner_id.name"/>
                                                <span class="badge badge-pill o_pms_pwa_badge_position">0</span>
                                            </span>
                                            <div class="float-left">
                                                <t t-esc="obj.partner_id.name"/>
                                            </div>
                                            <br/>
                                            <a class="float-left" t-att-href="'tel:' + str(obj.partner_id.mobile or obj.partner_id.phone)">
                                                <t t-esc="obj.partner_id.mobile or obj.partner_id.phone"/>
                                            </a>
                                            <span class="float-right "><i class="fa fa-user"/>3</span>
                                            <br/>
                                            <div class="progress mt-4">
                                                <div t-att-class="'progress-bar '
                                                    + ('bg-success ' if obj.partner_id.profile_completition &gt; 75 else ' ')
                                                    + ('bg-warning ' if 75 &gt; obj.partner_id.profile_completition &gt; 50 else ' ')
                                                    + ('bg-danger ' if obj.partner_id.profile_completition &lt; 50 else ' ')"
                                                    role="progressbar" t-att-style="'width:'+ str(obj.partner_id.profile_completition) + '%'"
                                                    t-att-aria-valuenow="obj.partner_id.profile_completition" aria-valuemin="0"
                                                    aria-valuemax="100"></div>
                                            </div>
                                        </td>
                                        <td class="o_pms_pwa_lh45">
                                            <t t-esc="obj.localizator"/>
                                        </td>
                                        <td class="o_pms_pwa_lh45">
                                            <t t-esc="obj.room_type_id.code_type"/>
                                        </td>
                                        <td class="o_pms_pwa_lh45 text-center">
                                            2
                                        </td>
                                        <td>
                                            <t t-esc="obj.checkin"/><br/><span class="o_pms_pwa_wler" t-esc="obj.arrival_hour"/>
                                        </td>
                                        <td>
                                            <t t-esc="obj.checkout"/><br/><span class="o_pms_pwa_wler" t-esc="obj.departure_hour"/>
                                        </td>
                                        <td class="text-center">
                                            <t t-if="obj.origin" t-esc="obj.origin"/>
                                            <span class="o_pms_pwa_wler" t-if="obj.detail_origin" t-esc="obj.detail_origin"/>
                                        </td>
                                        <td class="o_pms_pwa_lh45 text-center">
                                            <t t-esc="obj.folio_id.amount_total"/>
                                        </td>
                                        <td class="o_pms_pwa_lh45 text-center">
                                            <t t-esc="obj.folio_id.pending_amount"/>
                                        </td>
                                        <td class="o_pms_pwa_lh45 text-center">
                                            3
                                        </td>
                                        <td class="o_pms_pwa_lh45">
                                            <t t-if="obj.folio_internal_comment" t-esc="obj.folio_internal_comment"/>
                                        </td>
                                        <td class="o_pms_pwa_lh45">
                                            Desayuno
                                        </td>
                                        <td>
                                            <t t-set="pwa_action_buttons" t-value="json.loads(obj.pwa_action_buttons)"/>
                                            <t t-set="keys" t-value="list(pwa_action_buttons.keys())"/>
                                            <button t-att-url="pwa_action_buttons[keys[0]]" class="btn" type="button"><t t-esc="keys[0]"/></button>
                                            <span class="dropdown">
                                                <a role="button" class="btn fa fa-ellipsis-v" data-toggle="dropdown" href="#"/>
                                                <div class="dropdown-menu" aria-labelledby="dLabel">
                                                    <t t-foreach="pwa_action_buttons" t-as="button">
                                                        <button 
                                                            t-if="button != keys[0]"
                                                            t-att-url="pwa_action_buttons[button]"
                                                            class="dropdown-item"
                                                            type="button"><t t-esc="button"/></button>
                                                    </t>
                                                </div>
                                            </span>
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </div>
                </section>
            </div>
            <div t-if="pager" class="o_portal_pager text-center">
                <div class="o_pms_pwa_reservation_list_pagination">
                    <t
                        t-if="int(pager['page']['num']) + 1 &lt;= int(pager['page_count'])"
                    >
                        <a
                            t-att-href="pager['page_next']['url']"
                            style="display: none"
                        >Page <span t-esc="int(pager['page']['num']) + 1" />
                        </a>
                    </t>
                    <span
                        class="max-page"
                        t-esc="pager['page_count']"
                        style="display: none"
                    />
                </div>
            </div>
        </t>
    </template>
</odoo>
